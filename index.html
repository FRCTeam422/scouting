<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Snake Scout</title>
    <link rel="icon" href="favicon.ico">

    <link rel="stylesheet" href="styles.css">

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <!--<script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Poppins", "sans-serif"],
            },
          },
        },
      };
    </script>-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
      integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script src="js/script.js" defer></script>
  </head>
  <body style="font-size:5vw;">
    <header class="p-4 mb-10 bg-orange-500">
      <div class="center">
        <div class="titleBox">Scouting App: FRC Team 422 & Team 6377</div>
      </div>
    </header>
    <main>
      <center>
  <form method="post" action="https://script.google.com/macros/s/AKfycbxRASQDZc2A_wK8EhfN6t6rfFdaA7SEaRidUIid0ZIipZJFbxxociexKhVnDDDM3MAB/exec">
      <iframe name="dummyFrame" id="dummyFrame" style="display: none;"></iframe>
    
      <div id="preDiv">
        <h2>Prematch</h2>
        <label for="yourTeam">What Team Are You On? (422 or 6377):</label><br>
        <select name="Scouter's Team" id="yourTeam">
          <option value="422" selected>422</option>
          <option value="6377">6377</option>
        </select><br><br>
      
        <label for="initials" required>Scouter Initials:</label>
        <br>
        <input type="text" id="initials" class="texter" name="Initials" value="">
        <br>
        <br>
      
      
        <label for="teamNum">Team Number:</label><br>
        <select name="Team Num" id="teamNum">
          <option value="0000" selected>Select Team</option>
          <option value="16">16</option>
          <option value="28">28</option>
          <option value="51">51</option>
          <option value="85">85</option>
          <option value="88">88</option>
          <option value="166">166</option>
          <option value="217">217</option>
          <option value="281">281</option>
          <option value="359">359</option>
          <option value="422">422</option>
          <option value="484">484</option>
          <option value="533">533</option>
          <option value="668">668</option>
          <option value="971">971</option>
          <option value="973">973</option>
          <option value="1025">1025</option>
          <option value="1296">1296</option>
          <option value="1339">1339</option>
          <option value="1391">1391</option>
          <option value="1425">1425</option>
          <option value="1540">1540</option>
          <option value="1625">1625</option>
          <option value="1676">1676</option>
          <option value="1684">1684</option>
          <option value="1714">1714</option>
          <option value="1718">1718</option>
          <option value="1730">1730</option>
          <option value="1732">1732</option>
          <option value="1785">1785</option>
          <option value="1802">1802</option>
          <option value="2059">2059</option>
          <option value="2067">2067</option>
          <option value="2075">2075</option>
          <option value="2080">2080</option>
          <option value="2170">2170</option>
          <option value="2359">2359</option>
          <option value="2429">2429</option>
          <option value="2521">2521</option>
          <option value="2832">2832</option>
          <option value="3175">3175</option>
          <option value="3339">3339</option>
          <option value="3506">3506</option>
          <option value="3653">3653</option>
          <option value="3753">3753</option>
          <option value="3794">3794</option>
          <option value="4011">4011</option>
          <option value="4276">4276</option>
          <option value="4293">4293</option>
          <option value="4342">4342</option>
          <option value="4499">4499</option>
          <option value="4607">4607</option>
          <option value="4624">4624</option>
          <option value="4635">4635</option>
          <option value="4776">4776</option>
          <option value="4920">4920</option>
          <option value="4976">4976</option>
          <option value="5050">5050</option>
          <option value="5431">5431</option>
          <option value="5434">5434</option>
          <option value="5654">5654</option>
          <option value="5883">5883</option>
          <option value="6045">6045</option>
          <option value="6146">6146</option>
          <option value="6377">6377</option>
          <option value="6833">6833</option>
          <option value="6919">6919</option>
          <option value="7157">7157</option>
          <option value="7460">7460</option>
          <option value="7558">7558</option>
          <option value="7748">7748</option>
          <option value="8871">8871</option>
          <option value="9037">9037</option>
          <option value="9068">9068</option>
          <option value="9092">9092</option>
          <option value="9152">9152</option>
          <option value="9176">9176</option>
          <option value="9213">9213</option>
          <option value="9312">9312</option>
        </select>

        <br>
        <br>
      
        <label for="matchNum">Match Number:</label>
        <br>
        <input type="number" id="matchNum" class="texter" name="Match Number" value=""><br><br>
        
        <label for="robotPosition">Robot:</label><br>
        <select name="Robot Position" id="robotPosition" required>
          <option value="Select Option" selected>Select Position</option>
          <option value="R1">Red Open</option>
          <option value="R2">Red Center</option>
          <option value="R3">Red Bump</option>
          <option value="B1">Blue Open</option>
          <option value="B2">Blue Center</option>
          <option value="B3">Blue Bump</option>
        </select>
        <br>
        <br>
        <label for="noShow">No Show:</label>
        <br>
        <input type="checkbox" id="noShow">
        <!-- <input type="hidden" name='No Show' value="FALSE"> -->
        <br>
      </div>
      
      <div id="autoDiv">
        <h2>Auto</h2>
        <label for="taxied">Exited Community:</label><br>
        <!-- <p><i><h6>bumpers fully leave community at any point during auto</h6></i></p> -->
        <input type="checkbox" class="checkbox" name="Exit Community" value="1" placeholder="0" id="exitCommunity">
        <br>
        
        <label for="TSA">Top Scored:</label><br>
        <table>
          <tr>      
            <td><input type="button" class="buttonCube" id="atsSubBtnCube" value="-"></td>
            <td><input name="Auto Top Cubes Scored" value='0' id="autoTopsCube" hidden><p id="autoTopCube" name="Top Scored Cube">0</p></td>
            <td><input type="button" class="buttonCube" id="atsPlusBtnCube" value="+"></td>
          </tr>
        </table>
      
        <label for="MSA">Mid Scored:</label><br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="amsSubBtnCube" value="-"></td>
            <td><input name="Auto Mid Cubes Scored" value='0' id="autoMidsCube" hidden><p id="autoMidCube" name="Mid Scored Cube">0</p></td>
            <td><input type="button" class="buttonCube" id="amsPlusBtnCube" value="+"></td>
          </tr>
        </table>
      
        <label for="LSA">Low Scored:</label><br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="alsSubBtnCube" value="-"></td>
            <td><input name="Auto Low Cubes Scored" value='0' id="autoLowsCube" hidden><p id="autoLowCube" name="Low Scored Cube">0</p></td>
            <td><input type="button" class="buttonCube" id="alsPlusBtnCube" value="+"></td>
          </tr>
        </table>

        <label for="PDA">Pieces Dropped:</label><br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="apdSubBtnCube" value="-"></td>
            <td><input name="Auto Drops" value='0' id="autoDrops" hidden><p id="autoDrop" name="Drops">0</p></td>
            <td><input type="button" class="buttonCube" id="apdPlusBtnCube" value="+"></td>
          </tr>
        </table>
      
        <label for="climb">End of Auto Charge Station:</label><br>
        <select name="End of Auto" id="autoEnd">
          <option value="Choose Option" selected>Select Option</option>
          <option value="NA">Not Attempted</option>
          <option value="F">Attempted but Failed</option>
          <option value="D">Docked but not Engaged</option>
          <option value="E">Engaged and Docked</option>
        </select>
        <br>
        <br>
      </div>
      
        <div id="teleDiv">
        <h2>Teleop</h2>
      
        <label for="TST">Top Scored:</label>
        <br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="ttsSubBtnCube" value="-"></td>
            <td><input name="Teleop Top Cubes Scored" value='0' id="teleTopsCube" hidden>
              <p id="teleTopCube" name="Top Scored">0</p></td>
            <td><input type="button" class="buttonCube" id="ttsPlusBtnCube" value="+"></td>
          </tr>
        </table>
      
        <label for="TSM">Mid Scored:</label>
        <br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="tmsSubBtnCube" value="-"></td>
            <td><input name="Teleop Mid Cubes Scored" value='0' id="teleMidsCube" hidden><p id="teleMidCube" name="Mid Scored Cube">0</p></td>
            <td><input type="button" class="buttonCube" id="tmsPlusBtnCube" value="+"></td>
          </tr>
        </table>
      
        <label for="TSL">Low Scored:</label>
        <br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="tlsSubBtnCube" value="-"></td>
            <td><input name="Teleop Low Cubes Scored" value='0' id="teleLowsCube" hidden><p id="teleLowCube" name="Low Scored Cube">0</p></td>
            <td><input type="button" class="buttonCube" id="tlsPlusBtnCube" value="+"></td>
          </tr>
        </table>

        <label for="TSD">Double Scored:</label>
        <br>
        <table>
          <tr>
            <td><input type="button" class="buttonCube" id="tdsSubBtnCube" value="-"></td>
            <td><input name="Teleop Double Cubes Scored" value='0' id="teleDoublesCube" hidden><p id="teleDoubleCube" name="Double Scored Cube">0</p></td>
            <td><input type="button" class="buttonCube" id="tdsPlusBtnCube" value="+"></td>
          </tr>
        </table>
        
        <h2>Endgame</h2>
      
        <label for="climb">Charge Station:</label>
        <br>
        <select name="Charge Station" id="climb">
          <option value="Select Option" selected>Select Option</option>
          <option value="NA">None</option>
          <option value="P">Parked</option>
          <option value="D">Docked but not Engaged</option>
          <option value="E">Engaged and Docked</option>
        </select>
        <br>
        <br>
        </div>
        
        <div id="postDiv">
        <h2>Postmatch</h2>
      
        <label for="comments">Comments (150 char max):</label><br>
        <textarea id="comments" name="Comments" rows="4" cols="20" maxlength="150"></textarea>
      
          <div style="background-color:white; margin:20px;">
      <!-- <div id="generated"></div> -->
      <div style="margin:20px;"></div>
        <div id="qrcode" class="m-auto"></div>
      </div>
      <br></br>
      <div id="qrlabel"></div>
      <br></br>

      </div>
    </div>

      <br></br>
      <button type="reset" id="resetBtn" onclick="return confirm_reset();">Reset</button>
      <script>
        function confirm_reset() {
            return confirm("Are you sure you want to reset?");
          }
      </script>

      <br></br>
  </form>
    </div>

  <form id="generate-form" style="margin:20px;">
    <button style="width:80%; height:200px; background-color: #73c167; border-color: #73c167" type="submit">
      <p style="font-size: 5vw; color:white;">
        Generate QR Code</p>
    </button>
  </form>



  </main>

    <script>
    var autoTopPlusButtonCube = document.getElementById("atsPlusBtnCube"),
        autoTopSubButtonCube = document.getElementById("atsSubBtnCube"),
        autoTopDisplayCube = document.getElementById("autoTopCube"),
        autoTopValueCube = document.getElementById("autoTopsCube");

    var autoMidPlusButtonCube = document.getElementById("amsPlusBtnCube"),
        autoMidSubButtonCube = document.getElementById("amsSubBtnCube"),
        autoMidDisplayCube = document.getElementById("autoMidCube"),
        autoMidValueCube = document.getElementById("autoMidsCube");

    var autoLowPlusButtonCube = document.getElementById("alsPlusBtnCube"),
        autoLowSubButtonCube = document.getElementById("alsSubBtnCube"),
        autoLowDisplayCube = document.getElementById("autoLowCube"),
        autoLowValueCube = document.getElementById("autoLowsCube");
      
    var autoDropPlusButtonCube = document.getElementById("apdPlusBtnCube"),
        autoDropSubButtonCube = document.getElementById("apdSubBtnCube"),
        autoDropDisplayCube = document.getElementById("autoDrop"),
        autoDropValueCube = document.getElementById("autoDrops");

    var teleTopPlusButtonCube = document.getElementById("ttsPlusBtnCube"),
        teleTopSubButtonCube = document.getElementById("ttsSubBtnCube"),
        teleTopDisplayCube = document.getElementById("teleTopCube"),
        teleTopValueCube = document.getElementById("teleTopsCube"); 

    var teleMidPlusButtonCube = document.getElementById("tmsPlusBtnCube"),
        teleMidSubButtonCube = document.getElementById("tmsSubBtnCube"),
        teleMidDisplayCube = document.getElementById("teleMidCube"),
        teleMidValueCube = document.getElementById("teleMidsCube");

    var teleLowPlusButtonCube = document.getElementById("tlsPlusBtnCube"),
        teleLowSubButtonCube = document.getElementById("tlsSubBtnCube"),
        teleLowDisplayCube = document.getElementById("teleLowCube"),
        teleLowValueCube = document.getElementById("teleLowsCube")

    var teleDoublePlusButtonCube = document.getElementById("tdsPlusBtnCube"),
        teleDoubleSubButtonCube = document.getElementById("tdsSubBtnCube"),
        teleDoubleDisplayCube = document.getElementById("teleDoubleCube"),
        teleDoubleValueCube = document.getElementById("teleDoublesCube")

    // var teleDropPlusButtonCube = document.getElementById("tpdPlusBtnCube"),
    //     teleDropSubButtonCube = document.getElementById("tpdSubBtnCube"),
    //     teleDropDisplayCube = document.getElementById("teleDrop"),
    //     teleDropValueCube = document.getElementById("teleDrops")

    var noShow = document.getElementById("noShow");

    var teamNum = document.getElementById("teamNum").value,
        yourTeam = document.getElementById("yourTeam").value,
        initials = document.getElementById("initials").value,
        matchNum = document.getElementById("matchNum").value,
        robotPosition = document.getElementById("robotPosition").value,
        exitCommunity = document.getElementById("exitCommunity").value,
        climb = document.getElementById("climb").value,
        comments = document.getElementById("comments").value;

    autoTopPlusButtonCube.addEventListener('click', function(){addCount(autoTopDisplayCube, autoTopValueCube);});
    autoTopSubButtonCube.addEventListener('click', function(){subCount(autoTopDisplayCube, autoTopValueCube);});

    autoMidPlusButtonCube.addEventListener('click', function(){addCount(autoMidDisplayCube, autoMidValueCube);});
    autoMidSubButtonCube.addEventListener('click', function(){subCount(autoMidDisplayCube, autoMidValueCube);});

    autoLowPlusButtonCube.addEventListener('click', function(){addCount(autoLowDisplayCube, autoLowValueCube);});
    autoLowSubButtonCube.addEventListener('click', function(){subCount(autoLowDisplayCube, autoLowValueCube);});

    autoDropPlusButtonCube.addEventListener('click', function(){addCount(autoDropDisplayCube, autoDropValueCube);});
    autoDropSubButtonCube.addEventListener('click', function(){subCount(autoDropDisplayCube, autoDropValueCube);});

    teleTopPlusButtonCube.addEventListener('click', function(){addCount(teleTopDisplayCube, teleTopValueCube);});
    teleTopSubButtonCube.addEventListener('click', function(){subCount(teleTopDisplayCube, teleTopValueCube);});

    teleMidPlusButtonCube.addEventListener('click', function(){addCount(teleMidDisplayCube, teleMidValueCube);});
    teleMidSubButtonCube.addEventListener('click', function(){subCount(teleMidDisplayCube, teleMidValueCube);});

    teleLowPlusButtonCube.addEventListener('click', function(){addCount(teleLowDisplayCube, teleLowValueCube);});
    teleLowSubButtonCube.addEventListener('click', function(){subCount(teleLowDisplayCube, teleLowValueCube);});

    teleDoublePlusButtonCube.addEventListener('click', function(){addCount(teleDoubleDisplayCube, teleDoubleValueCube);});
    teleDoubleSubButtonCube.addEventListener('click', function(){subCount(teleDoubleDisplayCube, teleDoubleValueCube);});

    // teleDropPlusButtonCube.addEventListener('click', function(){addCount(teleDropDisplayCube, teleDropValueCube);});
    // teleDropSubButtonCube.addEventListener('click', function(){subCount(teleDropDisplayCube, teleDropValueCube);});
        
    function addCount(data_display, data_value_storage){
        count = Number(data_value_storage.value);
        count++;
        data_display.innerHTML = count;
        data_value_storage.value = count;
    };

    function subCount(data_display, data_value_storage) {
        count = Number(data_value_storage.value);
        if (count > 0) { 

        count -= 1;
        data_display.innerHTML = count;
        data_value_storage.value = count;
        }
    };

    var resetButton = document.getElementById("resetBtn");

    resetButton.addEventListener('click', function(){resetCounters();});
      
    function resetCounters() {
  
      autoTopDisplayCube.innerHTML = 0;
      autoTopValueCube.value = 0;

      autoMidDisplayCube.innerHTML = 0;
      autoMidValueCube.value = 0;

      autoLowDisplayCube.innerHTML = 0;
      autoLowValueCube.value = 0;

      autoDropDisplayCube.innerHTML = 0;
      autoDropValueCube.value = 0;

      teleTopDisplayCube.innerHTML = 0;
      teleTopValueCube.value = 0;

      teleMidDisplayCube.innerHTML = 0;
      teleMidValueCube.value = 0;

      teleLowDisplayCube.innerHTML = 0;
      teleLowValueCube.value = 0;

      teleDoubleDisplayCube.innerHTML = 0;
      teleDoubleValueCube.value = 0;

      // teleDropDisplayCube.innerHTML = 0;
      // teleDropValueCube.value = 0;

      noShowValue = 'FALSE';
    }


    const form = document.getElementById('generate-form');
    const qr = document.getElementById('qrcode');

    // Button submit
    const onGenerateSubmit = (e) => {
      e.preventDefault();

      clearUI();

      //const url = document.getElementById('url').value;
      //const data = document.getElementById('data').value;
      const yourTeam = document.getElementById("yourTeam").value;
      const initials = document.getElementById("initials").value;
      const teamNum = document.getElementById("teamNum").value;
      const matchNum = document.getElementById("matchNum").value;
      const robotPosition = document.getElementById("robotPosition").value;

      const autoTopsCube = document.getElementById("autoTopsCube").value;
      
      const autoMidsCube = document.getElementById("autoMidsCube").value;

      const autoLowsCube = document.getElementById("autoLowsCube").value;

      const autoDrops = document.getElementById("autoDrops").value;
      
      const autoEnd = document.getElementById("autoEnd").value;

      const teleTopsCube = document.getElementById("teleTopsCube").value;

      const teleMidsCube = document.getElementById("teleMidsCube").value;

      const teleLowsCube = document.getElementById("teleLowsCube").value;

      const teleDoublesCube = document.getElementById("teleDoublesCube").value;

      // const teleDrops = document.getElementById("teleDrops").value;
      
      const climb = document.getElementById("climb").value;

      const comments = document.getElementById("comments").value;
      
      const noShow = document.getElementById("noShow");
      const exitCommunity = document.getElementById("exitCommunity");

      var noShowValue = noShow.checked ? 'TRUE' : 'FALSE'; 
      var exitCommunityValue = exitCommunity.checked ? 'TRUE' : 'FALSE'; 

      setTimeout(() => {
        generateQRCode(yourTeam, initials, teamNum, matchNum, robotPosition, noShowValue, exitCommunityValue,
                       autoTopsCube, 
                       autoMidsCube,
                       autoLowsCube,
                       autoDrops,
                       autoEnd,
                       teleTopsCube,
                       teleMidsCube,
                       teleLowsCube,
                       teleDoublesCube,
                       climb, comments);

        qrLabel = document.getElementById('qrlabel')
        //console.log(initials)
        //console.log(initials.concat(" ", String(matchNum), " ", robotPosition))
        qrLabel.innerHTML = initials.concat(" Match ", String(matchNum), " ", robotPosition)

        // Generate the save button after the qr code image src is ready
        setTimeout(() => {
          // Get save url
          const saveUrl = qr.querySelector('img').src;
          // Create save button
          createSaveBtn(saveUrl);
        }, 50);
      }, 1000);
    };

    const sep = ";_|"
    // Generate QR code
    const generateQRCode = (yourTeam, initials, teamNum, matchNum, robotPosition, noShowValue, exitCommunityValue,
                            autoTopsCube,
                            autoMidsCube,
                            autoLowsCube,
                            autoDrops,
                            autoEnd,
                            teleTopsCube,
                            teleMidsCube,
                            teleLowsCube, 
                            teleDoublesCube,
                            // teleDrops,
                            wasDefendedValue,
                            climb, robotDisabledValue, comments) => {

      const qrcode = new QRCode('qrcode', {
        text: 'qm'.concat(sep, yourTeam , sep , initials , sep, teamNum, sep, matchNum , sep , robotPosition , sep , noShowValue,
          sep, exitCommunityValue, sep + autoTopsCube, sep + autoMidsCube, sep + autoLowsCube, sep + autoDrops, sep + autoEnd, sep + teleTopsCube, 
          sep + teleMidsCube, sep + teleLowsCube, sep + teleDoublesCube, /** sep + teleDrops,*/ sep + wasDefendedValue, sep + climb , sep , robotDisabledValue , sep , comments),
        width: 300,
        height: 300,
      });
    };

    // Clear QR code and save button
    const clearUI = () => {
      qr.innerHTML = '';
      const saveBtn = document.getElementById('save-link');
      if (saveBtn) {
        saveBtn.remove();
      }
    };

    // Create save button to download QR code as image
    const createSaveBtn = (saveUrl) => {
      const link = document.createElement('a');
      link.id = 'save-link';
      link.classList =
        'bg-red-500 hover:bg-red-700 text-white font-bold py-2 rounded w-1/3 m-auto my-5';
      link.href = saveUrl;
      link.download = 'qrcode';
      link.innerHTML = 'Save Image';
      document.getElementById('generated').appendChild(link);
    };

    form.addEventListener('submit', onGenerateSubmit);

    </script>
  </body>
</html>
